<section class="h-100 h-custom pb-0"
	style="color: var(- -color-primary)">
	<div class="container p-0 pb-0 h-100">
		<div class="pagetitle text">
			<nav>
				<ol class="breadcrumb mt-1 mb-1">
					<li class="breadcrumb-item"><a href="#home">Smart Book</a></li>
					<li class="breadcrumb-item active">Đặt hàng</li>
				</ol>
			</nav>
		</div>
		<div
			class="row d-flex justify-content-center align-items-center h-100">
			<div class="col-12">
				<div class="card card-registration card-registration-2">
					<div class="card-body p-0">
						<div class="row g-0">
							<div class="col-lg-8" style="min-height: 700px">
								<div class="p-3">
									<div class="d-flex align-items-center">
										<h3 class="fw-bold m-0 fs-3 text">
											<img src="/index/img/ship.png" width="35px"
												class="m-0 p-0 mb-2" alt=""> THÔNG TIN GIAO HÀNG
										</h3>
									</div>
									<hr class="mt-2 mb-2">
									<div class="header-cart fw-bold">
										<div class="row">
											<span class="text-center text">Người nhận hàng</span>
										</div>
									</div>
									<hr class="mt-2 mb-2">
									<div class="row p-lg-4 p-md-3 p-sm-2 p-1">
											<div class="col-md-6">
												<div class="col-md-12 mt-1 mb-1">
													<div class="form-floating">
														<input type="text" class="form-control" ng-model="fullname" id="name" placeholder="Smart Book">
														<label for="name" class="text-center">Tên người nhận</label>
														<span class="text-danger small ms-1" id="fullname"></span>
													</div>
												</div>
											</div>
											<div class="col-md-6 mt-1 mb-1">
												<div class="col-md-12">
													<div class="form-floating">
														<input type="text" class="form-control" ng-model="phoneNumber" id="sdt" placeholder="Smart Book">
														<label for="sdt" class="text-center">Số điện thoại</label>
														<span class="text-danger small ms-1" id="phoneNumber"></span>
													</div>
												</div>
											</div>
									</div>
									<hr class="mt-2 mb-2">
									<div class="header-cart fw-bold">
										<div class="row">
											<span class="text-center text">Địa chỉ nhận hàng</span>
										</div>
									</div>
									<hr class="mt-2 mb-2">
									<div class="row p-lg-4 p-md-3 p-sm-2 p-1">
										<div class="form-floating col-md-4 mt-1 mb-1">
							                    <select class="form-select" id="cityslt" ng-model="city" ng-change="changeCity()">
							                      <option value="" disabled>Chọn tỉnh/thành phố</option>
							                      <option ng-repeat="c in citys track by $index" value="{{c.id}}">{{c.name}}</option>
							                    </select>
							                    <label for="cityslt" class="text-center">Tỉnh/Thành phố</label>
							                    <span class="text-danger small ms-1" id="city"></span>
							             </div>
							             <div class="form-floating col-md-4 mt-1 mb-1">
							                    <select class="form-select" id="districtslt" ng-model="district" ng-disabled="city==''">
							                      <option value="" disabled>Chọn quận/huyện</option>
							                      <option ng-repeat="d in districts[city] track by $index" value="{{d.id}}">{{d.name}}</option>
							                    </select>
							                    <label for="districtslt" class="text-center">Quận/Huyện</label>
							                   	<span class="text-danger small ms-1" id="district"></span>
							             </div>
							             <div class="form-floating col-md-4 mt-1 mb-1">
							                    <select class="form-select" id="wardslt" ng-model="ward" ng-disabled="district==''">
							                      <option value="" disabled>Chọn xã/phường</option>
							                      <option ng-repeat="w in wards[district] track by $index" value="{{$index}}">{{w.name}}</option>
							                    </select>
							                    <label for="wardslt" class="text-center">Xã/Phường</label>
							                    <span class="text-danger small ms-1" id="ward"></span>
							             </div>
							             <div class="col-12 mt-md-3 mt-1 mb-1">
												<div class="col-md-12">
													<div class="form-floating">
														<input type="text" class="form-control" id="detail" ng-model="addressDetail" placeholder="Smart Book">
														<label for="detail" class="text-center">Số nhà, tên đường,...</label>
														<span class="text-danger small ms-1" id="addressDetail"></span>
													</div>
												</div>
										</div>
									</div>
									<hr class="mt-2 mb-2">
									<div class="header-cart fw-bold">
										<div class="row">
											<span class="text-center text">Hình thức giao hàng</span>
										</div>
									</div>
									<hr class="mt-2 mb-2">
									<div class="row p-lg-3 p-md-2 p-1">
										<div class="form-floating {{city=='1'?'col-md-4':'col-md-6'}} {{(trans.id==3 && city!='1')?'d-none':''}} mt-1 mb-1"  ng-repeat="trans in transportTypes track by $index">
							                <div class="form-check mt-1 d-flex justify-content-center">
												<input class="form-check-input" ng-change="changeTransportType()" ng-model="transportType.t" ng-checked="transportType.t == $index"
												 value="{{$index}}" type="radio" name="payMothod" id="payMothod{{trans.id}}">
												<label class="form-check-label" for="payMothod{{trans.id}}">&ensp;{{trans.value}}</label>
											</div>
							             </div>
									</div>
									<hr class="mt-2 mb-2">
									<span class="text-danger fw-bold"> * Lưu ý:</span><br>
									<span class="small">&ensp;- Hình thức giao hàng nhanh sẽ có thời gian giao hàng trong khoảng 1 - 3 ngày.</span><br>
									<span class="small">&ensp;- Hình thức giao hàng tích kiệm sẽ có thời gian giao hàng trong khoảng 5 - 7 ngày.</span><br>
									<span class="small">&ensp;- Hình thức giao hàng hoả tốc sẽ có thời gian giao hàng trong khoảng 8 giờ và chỉ áp dụng tại khu vực Hà Nội.</span><br>
								</div>
							</div>
							<div class="col-lg-4 bg-grey mt-md-0 mt-5">
								<div class="p-3 mt-md-0 mt-5">
									<h3 class="fw-bold m-0 fs-5  mt-sm-0 mt-5 text">
										<i class="fa-solid fa-circle-check"></i>&ensp;Xác nhận sản phẩm
									</h3>
									<hr class="mt-2 mb-2">
									<div class="row">
										<div class="col-6 fw-bold">Sản phẩm</div>
										<div class="col-2 fw-bold">SL</div>
										<div class="col-4 fw-bold">Đơn giá</div>
									</div>
									<div class="row p-0 m-0" ng-repeat="cart in carts track by $index">
										<hr class="mt-2 mb-2">
										<div class="col-6 small p-0"> {{cart.book.name}}</div>
										<div class="col-2 small">{{cart.amount}}</div>
										<div class="col-4 small">{{convertText(cart.book.price * (100-cart.book.discount)/100)}}</div>
									</div>	
									<hr class="mt-2 mb-2">
									<h3 class="fw-bold m-0 fs-5 text">
										<i class="fa-regular fa-credit-card"></i>&ensp;Phương thức thanh
										toán
									</h3>
									<hr class="mt-2 mb-2">
									<div class="form-check mt-2" ng-repeat="p in paymentTypes track by $index">
										<input class="form-check-input" ng-model="paymentType.p" ng-checked="paymentType.p == $index" ng-disabled="p.id!=1"
										 type="radio" name="pay" id="p{{$index}}" value="{{$index}}">
										<label class="form-check-label" for="p{{$index}}">{{p.value}}</label>
									</div>
									<hr class="mt-2 mb-2">
									<h3 class="fw-bold m-0 fs-5 text">
										<i class="fa-solid fa-ticket"></i>&ensp;Mã khuyến mãi
									</h3>

									<hr class="mt-2 mb-2">
									<div class="d-flex justify-content-between">
										<h6>Tổng sản phẩm</h6>
										<h6>{{carts.length +' sản phẩm' }}</h6>
									</div>
									<div class="d-flex justify-content-between">
										<h6>Tổng tiền sản phẩm</h6>
										<h6>{{convertText(total)}}</h6>
									</div>
									<div class="d-flex justify-content-between">
										<h6>Giảm giá</h6>
										<h6>{{convertText(getReduced())}}</h6>
									</div>
									<div class="d-flex justify-content-between">
										<h6>Tổng trọng lượng</h6>
										<h6>{{totalWeight}} Kg</h6>
									</div>
									<div class="d-flex justify-content-between">
										<h6>Phí vận chuyển</h6>
										<h6>{{convertText(transportFee)}}</h6>
									</div>
									<div class="d-flex justify-content-between mb-5">
										<h5 class="text-uppercase">Tổng</h5>
										<h5 ng-show="total>0">{{convertText(getTotal())}}</h5>
										<h5 ng-show="total==0">0đ</h5>
									</div>
									<button type="button" class="btn btn-dark btn-block btn-lg bg" ng-click="beforePay()">Thanh toán</button>

								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="confirmModal" tabindex="-1"
			aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel"><img src="/index/img/s2.png" class="m-0 w-50" alt=""></h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<h3 class="fw-bold text text-center mb-lg-3 mb-md-2 mb-1">Xác nhận thông tin giao hàng</h3>
						<div class="row fs-6 p-lg-2 p-md-1">
							<div class="col-6">
								<span class="fw-bold text">Người nhận hàng: </span>
								<span>{{fullname}}</span>
							</div>
							<div class="col-6">
								<span class="fw-bold text">Số điện thoại: </span>
								<span>{{phoneNumber}}</span>
							</div>
						</div>
						<div class="row fs-6 p-lg-2 p-md-1">
							<div class="col-12">
								<span class="fw-bold text">Địa chỉ nhận hàng: </span>
								<span>{{addressDetail + ", " + wards[district][ward].name + ", " + wards[district][ward].district.name + ", " + wards[district][ward].district.city.name}}</span>
							
							</div>
						</div>
						<div class="row fs-6 p-lg-2 p-md-1">
							<div class="col-12">
								<span class="fw-bold text">Hình thức giao hàng: </span>
								<span>{{transportTypes[transportType.t].value}}</span>
							</div>
						</div>
						<div class="row fs-6 p-lg-2 p-md-1">
							<div class="col-12">
								<span class="fw-bold text">Hình thức thanh toán: </span>
								<span>{{paymentTypes[paymentType.p].value}}</span>
							</div>
						</div>
						<div class="row fs-4 p-lg-2 p-md-1">
							<div class="col-12">
								<span class="fw-bold text">Tổng thanh toán: </span>
								<span class="fw-bold">{{convertText(getTotal())}}</span>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Không</button>
						<button type="button" class="btn btn-primary"
							data-bs-dismiss="modal" ng-click="pay()">Chắc chắn</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
